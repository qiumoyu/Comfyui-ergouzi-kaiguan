# 全局条件控制节点使用指南

## 概述

全局条件控制节点（全局条件控制🌐🔀）是二狗子开关套件的高级功能，它结合了条件判断和全局组控制能力，可以根据动态条件自动控制整个ComfyUI工作流中的所有节点组。

## 功能特点

### 🎯 智能条件判断
- 支持8种比较类型：等于、不等于、大于、小于、大于等于、小于等于、包含、不包含
- 自动数据类型识别（整数、浮点数、字符串）
- 条件反转功能
- 实时条件评估

### 🌐 全局组控制
- 5种控制模式：智能控制、全部忽略、全部禁用、全部启用、条件控制
- 支持指定目标组或控制所有组
- 三种节点状态：启用、忽略（bypass）、禁用
- 实时状态监控和反馈

### 🔧 高级配置
- 条件满足和不满足时的独立动作设置
- 多行组名输入支持
- 动态状态管理
- 调试信息输出

## 节点参数详解

### 必需参数

1. **enable_control** (启用控制)
   - 类型：布尔值
   - 默认：True
   - 功能：全局开关，控制是否启用条件控制功能

2. **input_value** (输入值)
   - 类型：任意类型
   - 功能：需要进行条件判断的输入值

3. **comparison_type** (比较类型)
   - 类型：下拉选择
   - 选项：等于、不等于、大于、小于、大于等于、小于等于、包含、不包含
   - 默认：等于

4. **comparison_value** (比较值)
   - 类型：字符串
   - 功能：与输入值进行比较的参考值

5. **control_mode** (控制模式)
   - 类型：下拉选择
   - 选项：
     - **智能控制**：条件为真时启用，为假时忽略
     - **全部忽略**：无条件忽略所有目标组
     - **全部禁用**：无条件禁用所有目标组
     - **全部启用**：无条件启用所有目标组
     - **条件控制**：根据条件结果执行不同动作

6. **condition_true_action** (条件为真时的动作)
   - 类型：下拉选择
   - 选项：启用、忽略、禁用
   - 默认：启用

7. **condition_false_action** (条件为假时的动作)
   - 类型：下拉选择
   - 选项：启用、忽略、禁用
   - 默认：禁用

8. **target_groups** (目标组)
   - 类型：多行文本
   - 功能：指定要控制的组名，每行一个，留空则控制所有组

9. **invert_condition** (反转条件)
   - 类型：布尔值
   - 默认：False
   - 功能：反转条件判断结果

### 输出参数

1. **输出** - 原始输入值的传递
2. **条件结果** - 条件判断的布尔结果
3. **控制状态** - 当前控制操作的描述信息

## 使用场景示例

### 场景1：根据prompt长度自动调整工作流

```
输入：prompt文本
比较类型：大于
比较值：100
控制模式：条件控制
条件为真动作：启用（使用高质量处理组）
条件为假动作：忽略（跳过高质量处理组）
```

### 场景2：根据图像尺寸选择处理策略

```
输入：图像宽度
比较类型：大于等于
比较值：1024
控制模式：智能控制
目标组：高分辨率处理组
```

### 场景3：关键词过滤控制

```
输入：prompt文本
比较类型：包含
比较值：NSFW
控制模式：条件控制
条件为真动作：禁用（禁用所有生成组）
条件为假动作：启用（正常处理）
```

### 场景4：质量评分控制

```
输入：质量评分
比较类型：小于
比较值：0.5
控制模式：条件控制
条件为真动作：忽略（跳过后处理）
条件为假动作：启用（执行完整流程）
```

## 控制模式详解

### 🧠 智能控制
自动根据条件结果选择最优动作：
- 条件为真 → 启用目标组
- 条件为假 → 忽略目标组

### 🔄 条件控制
精确控制不同条件下的行为：
- 可独立设置条件为真/假时的动作
- 支持复杂的业务逻辑

### ⚡ 直接控制
忽略条件判断，直接执行控制：
- 全部启用：强制启用所有目标组
- 全部忽略：强制忽略所有目标组  
- 全部禁用：强制禁用所有目标组

## 高级功能

### 📊 状态监控
通过右键菜单访问"🌐 全局控制设置"可以查看：
- 活跃控制节点数量
- 受控组状态
- 实时控制历史

### 🎛️ 快速控制
设置面板提供一键快速控制按钮：
- 全部启用
- 全部忽略
- 全部禁用
- 重置所有状态

### 🔍 调试支持
控制台输出详细调试信息：
- 条件判断过程
- 控制执行结果
- 组状态变化

## 最佳实践

### 1. 组织节点组
- 根据功能将相关节点归类到不同组
- 使用清晰的组名命名
- 避免将控制节点放入被控制的组中

### 2. 条件设计
- 使用明确的数值比较，避免类型转换错误
- 字符串比较注意大小写
- 合理使用条件反转功能

### 3. 控制策略
- 优先使用"智能控制"和"条件控制"模式
- 避免频繁的全局控制操作
- 配合其他开关节点形成层次化控制

### 4. 性能优化
- 指定具体的目标组，避免不必要的全局控制
- 定期清理无用的控制节点
- 监控控制状态，及时重置

## 故障排除

### 问题1：控制不生效
- 检查`enable_control`是否为True
- 确认目标组名是否正确
- 查看控制台调试信息

### 问题2：条件判断异常
- 验证输入值和比较值的数据类型
- 检查比较类型是否合适
- 尝试使用条件反转

### 问题3：组控制冲突
- 避免多个控制节点同时控制同一组
- 使用状态监控面板查看冲突
- 必要时重置所有状态

## 与其他节点配合

全局条件控制节点可以与二狗子开关套件的其他节点配合使用：

- **通用开关**：手动控制特定场景
- **逻辑跳过**：节点级别的条件控制
- **布尔跳过**：简单的布尔条件控制
- **混合开关**：组合多种控制方式

## 总结

全局条件控制节点是ComfyUI工作流自动化的强大工具，通过智能的条件判断和灵活的组控制，可以实现高度自动化和智能化的工作流。合理使用这个节点，可以大大提高工作效率，创建更加智能和响应式的AI处理流程。

---

**开发者**: 灵仙儿和二狗子  
**项目地址**: [Comfyui-ergouzi-kaiguan](https://github.com/11dogzi/Comfyui-ergouzi-kaiguan) 